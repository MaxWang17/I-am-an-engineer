{"code":"import { isObject } from \"@vue/shared/src\";\r\nimport { mutableHandlers, shallowReactiveHandlers, readonlyHandlers, shallowReadonlyHandlers, } from './baseHandlers';\r\nexport function reactive(target) {\r\n    return createReactiveObject(target, false, mutableHandlers);\r\n}\r\nexport function shallowReactive(target) {\r\n    return createReactiveObject(target, false, shallowReactiveHandlers);\r\n}\r\nexport function readonly(target) {\r\n    return createReactiveObject(target, true, readonlyHandlers);\r\n}\r\nexport function shallowReadonly(target) {\r\n    return createReactiveObject(target, true, shallowReadonlyHandlers);\r\n}\r\n// 是不是只读，是不是深度。完全可以用参数配置，所以考虑柯里化，公用同一个方法（省的写四遍）\r\n// vue3响应式底层核心原理是：new Proxy  其本质还是操作get和set\r\nconst reactiveMap = new WeakMap(); // 会自动垃圾回收，不会造成内存泄露，存储的key只能是对象\r\nconst readonlyMap = new WeakMap();\r\nexport function createReactiveObject(target, isReadonly, baseHanelers) {\r\n    // 如果目标不是对象，没法拦截了，reactive这个api只能拦截对象类型\r\n    if (!isObject(target)) {\r\n        return target;\r\n    }\r\n    // 如果某个对象已经被代理，就不要再次代理\r\n    const proxyMap = isReadonly ? readonlyMap : reactiveMap;\r\n    const exisProxy = proxyMap.get(target);\r\n    if (exisProxy) {\r\n        return exisProxy;\r\n    }\r\n    // 发现未被代理，那么代理一下，并存储到map里以备查询\r\n    const proxy = new Proxy(target, baseHanelers);\r\n    proxyMap.set(target, proxy); // 将要代理的对象和对应的代理结果缓存起来\r\n    return proxy;\r\n}\r\n//# sourceMappingURL=reactive.js.map","references":["E:/私人/I-am-an-engineer/Vue/Vue3SC/packages/shared/src/index.ts","E:/私人/I-am-an-engineer/Vue/Vue3SC/packages/reactivity/src/baseHandlers.ts"],"map":"{\"version\":3,\"file\":\"reactive.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/reactivity/src/reactive.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,iBAAiB,CAAA;AAC1C,OAAO,EACH,eAAe,EACf,uBAAuB,EACvB,gBAAgB,EAChB,uBAAuB,GAC1B,MAAM,gBAAgB,CAAA;AAIvB,MAAM,UAAU,QAAQ,CAAC,MAAM;IAC3B,OAAO,oBAAoB,CAAC,MAAM,EAAE,KAAK,EAAE,eAAe,CAAC,CAAA;AAC/D,CAAC;AACD,MAAM,UAAU,eAAe,CAAC,MAAM;IAClC,OAAO,oBAAoB,CAAC,MAAM,EAAE,KAAK,EAAE,uBAAuB,CAAC,CAAA;AACvE,CAAC;AACD,MAAM,UAAU,QAAQ,CAAC,MAAM;IAC3B,OAAO,oBAAoB,CAAC,MAAM,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAA;AAC/D,CAAC;AACD,MAAM,UAAU,eAAe,CAAC,MAAM;IAClC,OAAO,oBAAoB,CAAC,MAAM,EAAE,IAAI,EAAE,uBAAuB,CAAC,CAAA;AACtE,CAAC;AAED,+CAA+C;AAC/C,2CAA2C;AAC3C,MAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAC,CAAC,+BAA+B;AAClE,MAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAC;AAClC,MAAM,UAAU,oBAAoB,CAAC,MAAM,EAAE,UAAU,EAAE,YAAY;IACjE,uCAAuC;IACvC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;QACnB,OAAO,MAAM,CAAA;KAChB;IAED,sBAAsB;IACtB,MAAM,QAAQ,GAAG,UAAU,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAA;IACvD,MAAM,SAAS,GAAG,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;IACtC,IAAI,SAAS,EAAE;QACX,OAAO,SAAS,CAAA;KACnB;IACD,6BAA6B;IAC7B,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;IAC9C,QAAQ,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAA,CAAC,sBAAsB;IAElD,OAAO,KAAK,CAAC;AACjB,CAAC\"}"}
